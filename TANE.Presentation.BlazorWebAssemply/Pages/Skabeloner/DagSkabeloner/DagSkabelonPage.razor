@using TANE.Application.Groups.DagSkabeloner.Queries
@using TANE.Application.Groups.DagSkabeloner.Queries.Interfaces
@using TANE.Domain.Entities
@using TANE.Presentation.BlazorWebAssemply.Pages.Skabeloner.DagSkabeloner.Components
@using TANE.Application.Dtos.Skabeloner

@inject IReadDagSkabelon ReadDagSkabelon
@inject CustomStateProvider AuthStateProvider
@inject NavigationManager NavigationManager
@inject NotificationService NotificationService

@page "/skabeloner/dag/overview"

<PageTitle>Dag Skabeloner</PageTitle>

<DagSkabelonListComponent InjectedSkabeloner="DagSkabeloner" OnEdit="OnRowEditPressed" OnDelete="OnRowDeletePressed"/>

@code {
    public List<DagSkabelon> DagSkabeloner { get; set; } = new List<DagSkabelon>();

    private async Task OnRowEditPressed(DagSkabelon dagSkabelon)
    {
        Console.WriteLine($"Edit pressed for: {dagSkabelon.Id}");
    }

    private async Task OnRowDeletePressed(DagSkabelon dagSkabelon)
    {
        Console.WriteLine($"Delete pressed for: {dagSkabelon.Id}");
    }

    protected override async Task OnInitializedAsync()
    {

        await AuthStateProvider.RefreshTokenAsync(NavigationManager, NotificationService);

        DagSkabeloner = await ReadDagSkabelon.ReadAllDagSkabelonerAsync(AuthStateProvider.CurrentUser.Token);
        await base.OnInitializedAsync();
    }
}
