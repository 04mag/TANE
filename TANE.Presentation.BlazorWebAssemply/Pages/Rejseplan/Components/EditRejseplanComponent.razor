@using TANE.Application.Dtos

<RadzenTemplateForm TItem="RejseplanUpdateDto"
                    Data="@Model"
                    Submit="HandleSubmit">
  <ChildContent>
    <RadzenFieldset Text="Rediger Rejseplan">
      <RadzenStack Gap="1rem">

        <RadzenTextBox @bind-Value="Model.Titel"
                       Name="Titel"
                       Label="Titel"
                       Style="width:100%" />

        <RadzenTextArea @bind-Value="Model.Beskrivelse"
                        Name="Beskrivelse"
                        Label="Beskrivelse"
                        Rows="4"
                        Style="width:100%" />
        
        <RadzenNumeric @bind-Value="Model.AntalVoksne"
                       Name="AntalVoksne"
                       Label="Antal Voksne"
                       Style="width:100%" />
        <RadzenNumeric @bind-Value="Model.AntalBørn"
                       Name="AntalBørn"
                       Label="Antal Børn"
                       Style="width:100%" />
       


        <!-- Tilføj her de øvrige felter på samme måde -->

        <RadzenStack Direction="Row" Gap="1rem">
          <RadzenButton ButtonType="ButtonType.Submit"
                        Text="Gem" />
          <RadzenButton ButtonType="ButtonType.Button"
                        Text="Annuller"
                        Click="HandleCancel" />
        </RadzenStack>

      </RadzenStack>
    </RadzenFieldset>
  </ChildContent>
</RadzenTemplateForm>

@code {
  [Parameter, EditorRequired]
  public RejseplanReadDto Item { get; set; } = default!;

  [Parameter]
  public EventCallback<RejseplanUpdateDto> OnSaved { get; set; }

  [Parameter]
  public EventCallback OnCancelled { get; set; }

  private RejseplanUpdateDto Model { get; set; } = new();

  protected override void OnParametersSet()
  {
    // Kopiér alle felter fra ReadDto til UpdateDto
    Model = new RejseplanUpdateDto
    {
      Id                 = Item.Id,
      KundeId            = Item.KundeId,
      Titel              = Item.Titel,
      Beskrivelse        = Item.Beskrivelse,
      AntalVoksne        = Item.AntalVoksne,
      AntalBørn          = Item.AntalBørn,
      Lufthavn           = Item.Lufthavn,
      FlyPris            = Item.FlyPris,
      AntalDage          = Item.AntalDage,
      AfrejseTidspunkt   = Item.AfrejseTidspunkt,
      OpfølgningNote     = Item.OpfølgningNote,
      RejseplanStatus    = Item.RejseplanStatus, 
      RowVersion         = Item.RowVersion
    };
  }

  private async Task HandleSubmit()
  {

    await OnSaved.InvokeAsync(Model);
  }

  private async Task HandleCancel()
  {
    await OnCancelled.InvokeAsync();
  }
}
